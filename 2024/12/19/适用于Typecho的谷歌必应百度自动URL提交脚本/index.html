<!DOCTYPE html>
<html lang="zh">
    <head>
        <!-- base -->
<meta charset="UTF-8" />
<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="template" content="Old-Fasion-Theme" />

<!-- sitemap -->
<link
    rel="sitemap"
    type="application/xml"
    title="sitemap"
    href="/sitemap.xml"
/>

<!-- title -->
<title>
    适用于Typecho的谷歌必应百度自动URL提交脚本 | Runoneall
</title>

<!-- css dependencies -->

<link rel="stylesheet" href="/css/normalize.css">
<link rel="stylesheet" href="/css/grid.css">
<link rel="stylesheet" href="/css/highlight.css">
<link rel="stylesheet" href="/css/global.css">
<link rel="stylesheet" href="/css/sidebar.css">
<link rel="stylesheet" href="/css/post.css">
<link rel="stylesheet" href="/css/misc.css">
<link rel="stylesheet" href="/css/page.css">
<link rel="stylesheet" href="/css/footer.css">
<link rel="stylesheet" href="/css/dark.css" id="dark-style" disabled>


<!-- favicon -->
<link rel="shortcut icon" href="https://dev.oneall.eu.org/favicon.webp">

<!-- extra css -->


<!-- keywords -->

<meta name="keywords" content="Hexo,Blog,Runoneall" />

<!-- description -->

<meta name="description" content="仅适用于使用mysql数据库安装的typecho且使用默认URL结构！效果图： 参考：https://blog.csdn.net/qq_36905522/article/details/136024994 依赖：  python3.x python内置包：json，urllib python第三方包：requests，httplib2，oauth2client mysql-driver：https" />

<!-- rss -->
<link rel="alternate" href="/rss2.xml" title="RSS 2.0" type="application/application/rss+xml+xml">
<link rel="alternate" href="/atom.xml" title="ATOM 1.0" type="application/application/atom+xml+xml">

    <meta name="generator" content="Hexo 8.1.1"><link rel="alternate" href="/atom.xml" title="Runoneall" type="application/atom+xml">
<link rel="alternate" href="/rss2.xml" title="Runoneall" type="application/rss+xml">
</head>

    <body>
        <div id="outbox">
            <!-- header -->
            <div id="header" class="clearfix">
                <div class="container">
                    <div class="row">
                        <div class="site-name">
                            <a id="logo" href="/"
                                >Runoneall</a
                            >
                            <p
                                id="description_random_intro"
                                class="description"
                            >
                                Runoneall's Blog
                            </p>
                            <script>
                                var description_random_intro =
                                    document.getElementById(
                                        "description_random_intro",
                                    );
                                var descriptions = JSON.parse(
                                    `["路漫漫其修远兮，吾将上下而求索","天将降大任于是人也，必先苦其心志，劳其筋骨，饿其体肤，空乏其身，行拂乱其所为","惜秦皇汉武，略输文采；唐宗宋祖，稍逊风骚。俱往矣，数风流人物，还看今朝。"]`,
                                );
                                var random_intro =
                                    descriptions[
                                        Math.floor(
                                            Math.random() * descriptions.length,
                                        )
                                    ];
                                description_random_intro.innerHTML =
                                    random_intro;
                            </script>
                        </div>
                    </div>
                </div>
            </div>
            <!-- end header -->

            <!-- sidebar button -->
            <button id="side-btn" onclick="changeSideStatus()">
                <input id="side-flag" type="checkbox" />
                <label id="side-control" for="side-flag">≡</label>
            </button>

            <!-- left area -->
            <div id="left">
                <!-- left links -->
                <div id="left-links">
                    <!-- page links -->
                    <a
                        class=""
                        href="/"
                        >首页</a
                    >
                    
                    <br />
                    <a
                        class=""
                        href="/about/index.html"
                        >关于</a
                    >
                    
                    <br />
                    <a
                        class=""
                        href="/links/index.html"
                        >链接</a
                    >
                    
                    <br />
                    <a
                        class=""
                        href="/shortlink/index.html"
                        >短链</a
                    >
                    
                    <br />
                    <a
                        class=""
                        href="/search/index.html"
                        >搜索</a
                    >
                    
                    <!-- end page links -->

                    <!-- sidebar extra html -->
                    
                    <br />
                    <a href="/rss2.xml">RSS</a><br>
<a href="/sitemap.xml">Sitemap</a><br>
<a href="mailto:dev@oneall.eu.org">Email</a><br>
                    
                    <!-- end sidebar extra html -->

                    <br /><button id="dark-btn" onclick="changeDarkMode()">
                        更换主题
                    </button>
                </div>
                <!-- end left links -->
            </div>
            <!-- end left area -->

            <!-- right area -->
            <div id="right">
                <div class="row"><div class="col-mb-12 col-8" id="main" role="main">
    <!-- article body -->
    <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
        <!-- post title -->
        <h1 class="post-title" itemprop="name headline">
            <a itemprop="url" href="/2024/12/19/%E9%80%82%E7%94%A8%E4%BA%8ETypecho%E7%9A%84%E8%B0%B7%E6%AD%8C%E5%BF%85%E5%BA%94%E7%99%BE%E5%BA%A6%E8%87%AA%E5%8A%A8URL%E6%8F%90%E4%BA%A4%E8%84%9A%E6%9C%AC/"
                >适用于Typecho的谷歌必应百度自动URL提交脚本</a
            >
        </h1>
        <!-- end post title -->

        <!-- post meta -->
        <ul class="post-meta">
            <li itemprop="author" itemscope itemtype="http://schema.org/Person">
                作者:
                <a itemprop="name" href="#" rel="author"
                    >Tom Brown</a
                >
            </li>
            <li>
                时间:
                <time
                    itemprop="datePublished"
                    datetime="2024-12-19T10:28:00.000Z"
                    >2024-12-19</time
                >
            </li>
            
            <li>
                分类: 
                <a href="/categories/%E9%BB%98%E8%AE%A4/">
                    默认 </a
                >&nbsp;
                
            </li>
            
        </ul>
        <!-- end post meta -->

        <!-- post content -->
        <div class="post-content" itemprop="articleBody">
            <h1 id="仅适用于使用mysql数据库安装的typecho且使用默认URL结构！"><a href="#仅适用于使用mysql数据库安装的typecho且使用默认URL结构！" class="headerlink" title="仅适用于使用mysql数据库安装的typecho且使用默认URL结构！"></a>仅适用于使用mysql数据库安装的typecho且使用默认URL结构！</h1><p>效果图：<br><img src="https://s.rmimg.com/2024-12-19/1734598864-426541-2024-12-19-165530.png"></p>
<p>参考：<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_36905522/article/details/136024994">https://blog.csdn.net/qq_36905522/article/details/136024994</a></p>
<p>依赖：</p>
<ul>
<li>python3.x</li>
<li>python内置包：json，urllib</li>
<li>python第三方包：requests，httplib2，oauth2client</li>
<li>mysql-driver：<a target="_blank" rel="noopener" href="https://dev.oneall.eu.org/archives/15/%EF%BC%88%E8%8B%A5%E4%BD%A0%E6%98%AFserv00">https://dev.oneall.eu.org/archives/15/（若你是serv00</a> s2也可以直接用我提供的地址）</li>
<li>将下载的Google Index Api Key（一般为 <code>gen-lang-client-xxx.json</code> ）保存为 <code>GoogleIndexApiKey.json</code></li>
<li>准备必应和百度的API token</li>
</ul>
<p>代码：</p>
<pre><code class="language-python">import json
from urllib.parse import quote
from oauth2client.service_account import ServiceAccountCredentials
import httplib2
import requests

driver_url = &quot; mysql-driver地址 &quot;
query_info = {
    &quot;host&quot;: &quot;typecho博客安装数据库地址&quot;,
    &quot;port&quot;: &quot;typecho博客安装数据库端口&quot;,
    &quot;username&quot;: &quot;typecho博客安装数据库用户名&quot;,
    &quot;password&quot;: &quot;typecho博客安装数据库密码&quot;,
    &quot;database&quot;: &quot;typecho博客安装数据库名&quot;,
    &quot;querys&quot;: &quot;SELECT * FROM typecho_contents&quot;
}
response = requests.post(driver_url, query_info)

article = response.json()[0][&quot;results&quot;]
blog_link_base = &quot;博客主页地址&quot;  #结尾不要加 /，如 https://dev.oneall.eu.org
links = [blog_link_base, ]
for item in article:
    article_cid = item[&quot;cid&quot;]
    article_type = item[&quot;type&quot;]
    article_slug = item[&quot;slug&quot;]
    if article_type == &quot;post&quot;:
        links.append(f&quot;{blog_link_base}/archives/{article_cid}/&quot;)
        continue
    if article_type == &quot;page&quot;:
        links.append(f&quot;{blog_link_base}/{article_slug}.html&quot;)
        continue

bing_index_api_url = &quot;https://www.bing.com/indexnow?url={}&amp;key=必应API Key&quot;
baidu_index_api_url = f&quot;http://data.zz.baidu.com/urls?site={blog_link_base}&amp;token=百度API Token&quot;
google_index_scopes = [&quot;https://www.googleapis.com/auth/indexing&quot;, ]
google_index_endpoint = &quot;https://indexing.googleapis.com/v3/urlNotifications:publish&quot;
google_index_key = &quot;GoogleIndexApiKey.json&quot;
google_index_credentials = ServiceAccountCredentials.from_json_keyfile_name(google_index_key, scopes=google_index_scopes)
google_index_http = google_index_credentials.authorize(httplib2.Http())
for link in links:
    print(&quot;\nIndexing:&quot;, link)
    print(&quot;  Bing:&quot;, end=&quot; &quot;)
    response = requests.get(bing_index_api_url.format(quote(link)))
    print(response.status_code)
    print(&quot;  Baidu:&quot;, end=&quot; &quot;)
    response = requests.post(baidu_index_api_url, quote(link))
    print(response.status_code)
    print(&quot;  Google:&quot;, end=&quot; &quot;)
    google_index_content = json.dumps({
        &quot;url&quot;: link,
        &quot;type&quot;: &quot;URL_UPDATED&quot;
    })
    response, content = google_index_http.request(google_index_endpoint, method=&quot;POST&quot;, body=google_index_content)
    print(response[&quot;status&quot;])
</code></pre>

        </div>
        <!-- end post content -->
    </article>
    <!-- end article body -->
</div>
</div>
            </div>
            <!-- end right area -->

            <!-- footer -->
            <div id="footer" role="contentinfo">
                &copy; 2025
                <a href="/">Runoneall</a>.
                <a target="_blank" rel="noopener" href="https://github.com/runoneall/blog/tree/theme"
                    >Old Fasion</a
                >
                Theme. Powered by <a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a>.
            </div>
            <!-- end footer -->
        </div>
        <!-- end outbox -->

        <!-- extra html -->


<!-- extra js -->

<script>
    console.log(String.raw`
            ___              __
      _____<  /____ _   ____/ /___  _   __
     / ___// // __ `+ "`" + String.raw`/  / __  // _ \| | / /
    / /   / // /_/ /  / /_/ //  __/| |/ /
   /_/   /_/ \__,_/   \__,_/ \___/ |___/

LET THE UNFAIRNESS OF THE WORLD BOW BEFORE ME
`)
</script>


<!-- js dependencies -->

<script src="/js/dark.js"></script>
<script src="/js/highlight.js"></script>
<script src="/js/sidebar.js"></script>


<!-- code highlight -->
<script defer>
    hljs.highlightAll();
</script>

    </body>
</html>
